<!DOCTYPE html>
<html lang="ru">
<head>
	<title>Глубокое погружение в webpack</title>
	<meta charset="utf-8">
	<meta name="viewport" content="width=792, user-scalable=no">
	<meta http-equiv="x-ua-compatible" content="ie=edge">
	<link rel="stylesheet" href="shower/themes/bright/styles/screen.css">
	<style>
		.intro {
			text-align: center;
		}
		.intro h3 {
			font-size: 200%;
			margin-bottom: 1em;
		}
		.intro h3, .intro p, .intro a {
			color: white;
		}
		.icon {
			width: 24px;
			height: 24px;
			vertical-align: middle;
		}
	</style>
</head>
<body class="full">

<header class="caption">
	<h1>Глубокое погружение в webpack</h1>

	<p>Владимир Кузнецов (<a href="https://twitter.com/mistakster">@mistakster</a>), Graph</p>
</header>

<section class="slide intro shout" id="intro">
	<div>
		<h3>Глубокое погружение в webpack</h3>
		<p>
			Владимир Кузнецов,
			<a target="_blank" href="https://twitter.com/mistakster">@mistakster</a>,
			Graph
		</p>
		<p>FrontTalks, сентябрь 2015</p>
	</div>
</section>

<section class="slide shout">
	<div>
		<h2>Для чего нужен webpack?</h2>
	</div>
</section>

<section class="slide">
	<div>
		<h2>Для чего нужен webpack?</h2>
		<ol>
			<li>создание упаковок из JavaScript-модулей;</li>
			<li>преобразование ресурсов из одного формата в другой;</li>
			<li>запуск задач.</li>
		</ol>
	</div>
</section>

<section class="slide shout">
	<div>
		<h2>Форматы модулей</h2>
	</div>
</section>

<section class="slide">
	<div>
		<h2>CommonJS</h2>
		<ul>
			<li>один файл &mdash; один модуль;</li>
			<li>синхронная загрузка модулей;</li>
			<li>код модулей не&nbsp;может быть исполнен в&nbsp;браузере без модификаций&nbsp;&mdash;
				формат разрабатывался исключительно для&nbsp;выполнения на&nbsp;сервере или внутри приложения.</li>
		</ul>
	</div>
</section>

<section class="slide">
	<div>
		<h2>AMD (Asynchronous Module Definition)</h2>
		<ul>
			<li>код может исполнятся в браузере без модификаций;</li>
			<li>модуль может использоваться как обёртка для CommonJS-модуля;</li>
			<li>возможна асинхронная загрузка модулей;</li>
			<li>модуль может зависеть от данных любых типов&nbsp;&mdash;<br>текст, шаблоны, стили и т.п.</li>
		</ul>
	</div>
</section>

<section class="slide">
	<div>
		<h2>UMD (Universal Module Definition)</h2>
		<p>Универсальная обёртка, которая в&nbsp;зависимости от&nbsp;окружения
			экспортирует модуль как CommonJS или как AMD.</p>
		<p>При создании упаковки, webpack предпочитает AMD-релизацию.</p>
	</div>
</section>

<section class="slide">
	<div>
		<h2>Браузеры пока не умеют загружать модули.</h2>
		<p>CommonJS нужна обёртка и глобальная функция <code>require</code></p>
		<p>AMD нужна глобальная функция <code>define</code></p>
	</div>
</section>

<section class="slide">
	<div>
		<h2>Webpack делает статический анализ кода</h2>
		<p>Так он строит дерево зависимостей и собирает упаковку.</p>
	</div>
</section>

<section class="slide">
	<div>
		<h2>Конфигурация webpack</h2>
		<pre>[Вставить пример конфига]</pre>
	</div>
</section>

<section class="slide">
	<div>
		<h2>Файл конфигурации</h2>
		<p>Явно указываем файл конфигурации</p>
		<pre>
			<code>$ webpack --config ./configs/site.js</code>
			<code>$ webpack --config ./configs/admin.js</code>
		</pre>
	</div>
</section>

<section class="slide">
	<div>
		<h2>Файл конфигурации</h2>
		<p>Конфигурация по-умолчанию</p>
		<pre>
			<code>webpack.config.js</code>
		</pre>
	</div>
</section>

<section class="slide">
	<div>
		<h2>Режим наблюдения за исходниками</h2>
		<pre><code>$ webpack --watch</code></pre>
	</div>
</section>

<section class="slide shout">
	<div>
		<h2>Загрузчики ресурсов</h2>
	</div>
</section>

<section class="slide">
	<div>
		<h2>Загрузчики ресурсов</h2>
		<ul>
			<li class="next">ES2015, JSX, TypeScript, &hellip;</li>
			<li class="next">CSS, LESS, SASS, Stylus, &hellip;</li>
			<li class="next">PNG, JPEG, SVG, &hellip;</li>
			<li class="next">Handlebars, Jade, &hellip;</li>
		</ul>
	</div>
</section>

<section class="slide">
	<div>
		<h2>Загрузчики</h2>
		<ul>
			<li>preLoaders</li>
			<li>loaders</li>
			<li>require('raw!./file.txt')</li>
			<li>postLoaders</li>
		</ul>
	</div>
</section>

<section class="slide">
	<div>
		<h2>В <strong>require</strong> можно подавлять другие загрузчики</h2>
		<ol>
			<li><code>require(&quot;<mark>!</mark>raw!./file.txt&quot;)</code> нет preLoaders</li>
			<li><code>require(&quot;<mark>-!</mark>raw!./file.txt&quot;)</code> нет preLoaders и loader</li>
			<li><code>require(&quot;<mark>!!</mark>raw!./file.txt&quot;)</code> нет загрузчиков</li>
		</ol>
	</div>
</section>

<section class="slide">
	<div>
		<h2>Загрузка программных модулей</h2>
		<p>Модуль пропускается через транспайлер, который переводит исходный код
			с&nbsp;одного языка или диалекта JavaScript на&nbsp;другой (скорее всего, ES5).</p>
	</div>
</section>

<section class="slide">
	<div>
		<h2>Загрузка стилей</h2>
		<ol>
			<li>пропускаем стили через пре- и пост-процессоры;</li>
			<li>css-loader преобразует текстовый файл в JS-модуль;</li>
			<li>style-loader добавляет в&nbsp;модуль код, который вставляет в&nbsp;документ содержимое тегом &lt;style;&gt;</li>
		</ol>
	</div>
</section>

<section class="slide">
	<div>
		<h2>Загрузка стилей</h2>
		<p>Стили удобно держать внутри скриптов на стадии разработки или для SPA.</p>
	</div>
</section>

<section class="slide">
	<div>
		<h2>Загрузка стилей</h2>
		<p>На практике, они должны загрузиться до контента.
			Extract Text Plugin извлекает обработанные стили и сохраняет в указанный файл.
			Таким образом, вы можете добавить их на страницу тегом &lt;link&gt;</p>
	</div>
</section>

<section class="slide">
	<div>
		<h2>Загрузка стилей</h2>
		<p>Если внутри CSS вы ссылаетесь на какие-то локальные ресурсы, то они тоже будут обработаны загрузчиками.</p>
	</div>
</section>

<section class="slide">
	<div>
		<h2>Загрузка картинок и шрифтов</h2>
		<ul>
			<li>file-loader</li>
			<li>url-loader</li>
		</ul>
	</div>
</section>

<section class="slide">
	<div>
		<h2>Загрузка шаблонов</h2>
		<p>Шаблоны преобразуются в JS-код. К ним в зависимости добавляется &laquo;runtime&raquo; шаблонизатора.</p>
		<p>Модуль экспортирует функцию, вызвав которую с нужными параметрами вы получите, например, кусок HTML в виде строки.</p>
	</div>
</section>

<section class="slide">
	<div>
		<h2>Пишем свой загрузчик</h2>
		<pre>
			<code>module.exports = function (content) {</code>
			<code>  this.cacheable();</code>
			<code>  return transform(content);</code>
			<code>};</code>
		</pre>
	</div>
</section>

<section class="slide">
	<div>
		<h2>Пишем свой загрузчик</h2>
		<pre>
			<code>module.exports = function (content, map) {</code>
			<code>  var callback = this.async();</code>
			<code>  transformAsync(content, map, callback);</code>
			<code>  // callback(err, result, map); </code>
			<code>};</code>
		</pre>
	</div>
</section>

<section class="slide">
	<div>
		<h2>Пишем свой загрузчик</h2>
		<pre>
			<code>module.exports = function (content) {</code>
			<code>  var callback = this.async();</code>
			<code>  var externalFile = path.resolve(&quot;stuff.js&quot;);</code>
			<code>  this.addDependency(externalFile);</code>
			<code>  appendExternalFile(content, externalFile, callback);</code>
			<code>};</code>
		</pre>
	</div>
</section>

<section class="slide">
	<div>
		<h2>Опции загрузчика</h2>
		<p>Передаются в виде строки запроса при описании загрузчика.</p>
		<pre><code>require("loader?with=parameter!./file");</code></pre>
		<p>Как правило, загрузчики пользуются модулем
			<a href="https://github.com/webpack/loader-utils" target="_blank">loader-utils</a>
			для разбора параметров.</p>
	</div>
</section>

<section class="slide">
	<div>
		<h2>Опции загрузчика</h2>
		<p>Можно указать в виде свойства объекта конфигурации webpack.</p>
		<pre>
			<code>module.exports = {</code>
			<code>  yourAwesomeLoader: {</code>
			<code>    // тут будет конфигурация загрузчика</code>
			<code>  }</code>
			<code>};</code>
		</pre>
	</div>
</section>

<section class="slide">
	<div>
		<h2>Опции загрузчика</h2>
		<pre>
			<code>var query = loaderUtils.parseQuery(this.query);</code>
			<code>var configKey = query.config || "yourAwesomeLoader";</code>
			<code>var config = this.options[configKey];</code>
		</pre>
	</div>
</section>

<section class="slide">
	<div>
		<h2>Документация по загрузчикам</h2>
		<ol>
			<li><a href="http://webpack.github.io/docs/loaders.html" target="_blank">Loaders</a></li>
			<li><a href="http://webpack.github.io/docs/how-to-write-a-loader.html" target="_blank">How to write a loader</a></li>
			<li><a href="http://webpack.github.io/docs/list-of-loaders.html" target="_blank">List of loaders</a></li>
		</ol>
	</div>
</section>

<section class="slide shout">
	<div>
		<h2>Плагины</h2>
	</div>
</section>

<section class="slide">
	<div>
		<h2>Плагины</h2>
		<ul>
			<li>имеют доступ ко всем модулям (до и после трансформации);</li>
			<li>могут добавлять в упаковку свои модули (например, &laquo;runtime&raquo;);</li>
			<li>имеют доступ ко всем ресурсам, создаваемым после упаковки.</li>
			<li>применяются для изменения конфигурации сборки, оптимизации, добавления в модули каких-то объектов, горячего обновления ресурсов.</li>
		</ul>
	</div>
</section>

<section class="slide">
	<div>
		<h2>Документация по плагинам</h2>
		<ol>
			<li><a href="http://webpack.github.io/docs/plugins.html" target="_blank">Plugins</a></li>
			<li><a href="http://webpack.github.io/docs/list-of-plugins.html" target="_blank">List of plugins</a></li>
		</ol>
	</div>
</section>

<section class="slide shout">
	<div>
		<h2>Примеры из жизни</h2>
	</div>
</section>

<section class="slide shout">
	<div>
		<h2>Несколько точек входа</h2>
	</div>
</section>

<section class="slide shout">
	<div>
		<h2>Автоматическо разделение кода и асинхронная загрузка частей</h2>
	</div>
</section>

<section class="slide shout">
	<div>
		<h2>Некешируемый загрузчик приложения</h2>
	</div>
</section>

<section class="slide shout">
	<div>
		<h2>Подавляем ненужные ресурсы</h2>
	</div>
</section>

<section class="slide shout">
	<div>
		<h2>Сервер разработки и горячее обновление</h2>
	</div>
</section>

<section class="slide shout">
	<div>
		<h2>Бонус: запуск&nbsp;задач</h2>
	</div>
</section>



<section class="slide" id="contacts">
	<div>
		<h2>Владимир Кузнецов</h2>
		<p>
			<img src="assets/twitter.svg" class="icon">
			<a href="http://twitter.com/mistakster" target="_blank">@mistakster</a> (English)<br>
			<img src="assets/twitter.svg" class="icon">
			<a href="http://twitter.com/mista_k" target="_blank">@mista_k</a> (больше про жизнь)
		</p>
		<p>
			<img src="assets/globe.svg" class="icon">
			<a href="http://noteskeeper.ru" target="_blank">noteskeeper.ru</a>
		</p>
		<p>Слайды презентации: <a href="http://mistakster.github.io/fronttalks-webpack/">mistakster.github.io/fronttalks-webpack</a>
	</div>
</section>

<div class="progress"><div></div></div>

<script src="shower/shower.min.js"></script>
<!-- Copyright © 2015 Владимир Кузнецов -->
</body>
</html>
